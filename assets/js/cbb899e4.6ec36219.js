"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[616],{220:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"configuration","title":"Configuration Guide","description":"FastProxy uses a YAML-based configuration system with support for multiple configuration sources. The configuration structure is based on actual implementation found in the common/config, inproxy/inconfig, and outproxy/outconfig packages.","source":"@site/docs/configuration.mdx","sourceDirName":".","slug":"/configuration","permalink":"/fast_proxy/docs/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/configuration.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"getting-started","permalink":"/fast_proxy/docs/getting-started"},"next":{"title":"Architecture","permalink":"/fast_proxy/docs/architecture"}}');var r=i(4848),t=i(8453);const s={sidebar_position:3},c="Configuration Guide",a={},l=[{value:"Configuration Structure",id:"configuration-structure",level:2},{value:"Common Configuration Elements",id:"common-configuration-elements",level:2},{value:"InProxy Configuration",id:"inproxy-configuration",level:2},{value:"OutProxy Configuration",id:"outproxy-configuration",level:2},{value:"Encryption Configuration",id:"encryption-configuration",level:2},{value:"Signing Configuration",id:"signing-configuration",level:2},{value:"Compression Configuration",id:"compression-configuration",level:2},{value:"Apollo Configuration Center Integration",id:"apollo-configuration-center-integration",level:2},{value:"Service Call Type Configuration",id:"service-call-type-configuration",level:2},{value:"HTTP Client Configuration",id:"http-client-configuration",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configuration-guide",children:"Configuration Guide"})}),"\n",(0,r.jsxs)(n.p,{children:["FastProxy uses a YAML-based configuration system with support for multiple configuration sources. The configuration structure is based on actual implementation found in the ",(0,r.jsx)(n.code,{children:"common/config"}),", ",(0,r.jsx)(n.code,{children:"inproxy/inconfig"}),", and ",(0,r.jsx)(n.code,{children:"outproxy/outconfig"})," packages."]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-structure",children:"Configuration Structure"}),"\n",(0,r.jsx)(n.p,{children:"The main configuration contains these key sections:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# Proxy settings\nproxy:\n  forwardAddress: http://127.0.0.1:9833/inProxy  # Address to forward requests to\n\n# Application settings\napplication:\n  name: in_proxy      # Service name\n  port: 8033          # Port to listen on\n  contextPath: /inProxy  # Context path for the service\n\n# RPC configuration\nrpc:\n  serviceHeaderName: C_ServiceName  # Header name for service identification\n\n# Service-specific configurations\nserviceConfig:\n  song_service:\n    encryptKeyName: encrypt.key.room.v2   # Name of the encryption key to use\n    signKeyName: sign.key.room.v1        # Name of the signing key to use\n    encryptEnable: true                   # Enable encryption\n    signEnable: true                      # Enable signing\n    compressEnable: true                  # Enable compression\n\n# Key configurations\nsignKeyConfig:\n  sign.key.room.v1: abcd   # Signing key values\n  sign.key.room.v2: abcd\n\nencryptKeyConfig:\n  encrypt.key.room.v1: ABCDABCDABCDABCDW  # Encryption key values\n  encrypt.key.room.v2: ABCDABCDABCDABCD\n\n# Service call type configurations\nserviceCallTypeConfig:\n  song_service:\n    /token_service/api/service:\n      callType: 1    # Type of call (1 = direct, 2 = forward)\n      qps: 10        # Queries per second limit\n\n# HTTP client settings\nhttpClient:\n  MaxIdleConns: 5000           # Maximum idle connections in pool\n  MaxIdleConnsPerHost: 3000    # Maximum idle connections per host\n\n# FastHTTP settings\nfastHttp:\n  enable: true    # Enable FastHTTP for improved performance\n"})}),"\n",(0,r.jsx)(n.h2,{id:"common-configuration-elements",children:"Common Configuration Elements"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"common"})," package defines the base configuration interface with these key methods:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ServerName()"})," - Returns the service name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ServerPort()"})," - Returns the server port"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ServiceRpcHeaderName()"})," - Returns the header name used to identify service"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GetServiceConfig(serviceName string)"})," - Gets configuration for a specific service"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GetTimeoutConfigByName(name string, uri string)"})," - Gets timeout configuration for specific endpoints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"HttpClientMaxIdleConns()"})," - Gets HTTP client max idle connections"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FastHttpEnable()"})," - Whether to enable FastHTTP"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"inproxy-configuration",children:"InProxy Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"inproxy"})," package handles incoming traffic and accepts a configuration implementing the ",(0,r.jsx)(n.code,{children:"inconfig.Config"})," interface with methods:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ServerContextPath()"})," - Returns the server's context path"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GetCallTypeConfigByName(name string, uri string)"})," - Gets call type config"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ServiceQps(name string, uri string)"})," - Gets QPS limit for service"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ContainsCallPrivilege(name string, uri string)"})," - Checks if call has privilege"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"outproxy-configuration",children:"OutProxy Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"outproxy"})," package handles outgoing traffic and accepts a configuration implementing the ",(0,r.jsx)(n.code,{children:"outconfig.Config"})," interface with methods:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ForwardAddress()"})," - Returns the address to forward requests to"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"encryption-configuration",children:"Encryption Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["Encryption is configured using the ",(0,r.jsx)(n.code,{children:"encrypt"})," package with these settings in the service configuration:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"encryptKeyName"})," - Name of the encryption key to use"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"encryptEnable"})," - Whether to enable encryption"]}),"\n",(0,r.jsxs)(n.li,{children:["The actual encryption keys are defined in ",(0,r.jsx)(n.code,{children:"encryptKeyConfig"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"signing-configuration",children:"Signing Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["Signing is configured using the ",(0,r.jsx)(n.code,{children:"sign"})," package with these settings:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"signKeyName"})," - Name of the signing key to use"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"signEnable"})," - Whether to enable signing"]}),"\n",(0,r.jsxs)(n.li,{children:["The actual signing keys are defined in ",(0,r.jsx)(n.code,{children:"signKeyConfig"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"compression-configuration",children:"Compression Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["Compression is handled by the ",(0,r.jsx)(n.code,{children:"compress"})," package:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"compressEnable"})," - Whether to enable compression"]}),"\n",(0,r.jsx)(n.li,{children:"Uses FastHTTP's built-in compression for performance"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"apollo-configuration-center-integration",children:"Apollo Configuration Center Integration"}),"\n",(0,r.jsx)(n.p,{children:"FastProxy includes built-in support for Apollo Configuration Center:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apollo:\n  apolloAddr: "http://your-apollo-server:8080"  # Apollo server address\n  appId: "fastproxy"                            # Application ID\n  cluster: "default"                           # Cluster name\n  namespaceName: "application"                 # Namespace\n'})}),"\n",(0,r.jsx)(n.p,{children:"To use Apollo configuration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'import "github.com/Kingson4Wu/fast_proxy/common/apollo"\n\n// Initialize Apollo configuration\napollo.InitApolloConfig(&apollo.Config{\n    ApolloAddr: "http://your-apollo-server:8080",\n    AppID:      "fastproxy",\n    Cluster:    "default",\n    NamespaceName: "application",\n})\n'})}),"\n",(0,r.jsx)(n.h2,{id:"service-call-type-configuration",children:"Service Call Type Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Services can be configured with specific call types and QPS limits:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"serviceCallTypeConfig:\n  service_name:\n    /api/endpoint:\n      callType: 1    # 1: direct call, 2: forwarded call\n      qps: 1000      # Queries per second limit\n      timeout: 5000  # Timeout in milliseconds\n      limit: 2000    # Connection limit\n"})}),"\n",(0,r.jsx)(n.h2,{id:"http-client-configuration",children:"HTTP Client Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Fine-tune the HTTP client behavior:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'httpClient:\n  MaxIdleConns: 5000           # Total max idle connections\n  MaxIdleConnsPerHost: 3000    # Max idle connections per host\n  IdleConnTimeout: "90s"       # How long to keep idle connections alive\n  ResponseHeaderTimeout: "10s" # Timeout for response headers\n'})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var o=i(6540);const r={},t=o.createContext(r);function s(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);