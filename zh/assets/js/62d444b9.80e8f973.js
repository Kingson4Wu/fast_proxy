"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[208],{223:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"performance","title":"Performance & Optimization","description":"FastProxy is designed for high-performance operation in production environments. It leverages the fasthttp library for efficient request handling and provides various configuration options to optimize performance.","source":"@site/docs/performance.mdx","sourceDirName":".","slug":"/performance","permalink":"/fast_proxy/zh/docs/performance","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/performance.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Architecture","permalink":"/fast_proxy/zh/docs/architecture"},"next":{"title":"Deployment & Operations","permalink":"/fast_proxy/zh/docs/deployment"}}');var s=i(4848),o=i(8453);const t={sidebar_position:5},c="Performance & Optimization",l={},a=[{value:"Performance Characteristics",id:"performance-characteristics",level:2},{value:"Benchmarks",id:"benchmarks",level:3},{value:"Optimizations",id:"optimizations",level:3},{value:"Configuration for Performance",id:"configuration-for-performance",level:2},{value:"FastHTTP Settings",id:"fasthttp-settings",level:3},{value:"HTTP Client Configuration",id:"http-client-configuration",level:3},{value:"Service-Specific Tuning",id:"service-specific-tuning",level:3},{value:"Encryption Performance",id:"encryption-performance",level:3},{value:"Performance Tuning Strategies",id:"performance-tuning-strategies",level:2},{value:"Enable FastHTTP",id:"enable-fasthttp",level:3},{value:"Connection Management",id:"connection-management",level:3},{value:"Compression Optimization",id:"compression-optimization",level:3},{value:"Rate Limiting",id:"rate-limiting",level:3},{value:"Monitoring Performance",id:"monitoring-performance",level:2},{value:"Built-in Metrics",id:"built-in-metrics",level:3},{value:"Logging Performance",id:"logging-performance",level:3},{value:"Profiling",id:"profiling",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Production Setup",id:"production-setup",level:3},{value:"Security vs Performance Trade-offs",id:"security-vs-performance-trade-offs",level:3},{value:"Performance Testing",id:"performance-testing",level:3},{value:"Scaling Considerations",id:"scaling-considerations",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"performance--optimization",children:"Performance & Optimization"})}),"\n",(0,s.jsx)(n.p,{children:"FastProxy is designed for high-performance operation in production environments. It leverages the fasthttp library for efficient request handling and provides various configuration options to optimize performance."}),"\n",(0,s.jsx)(n.h2,{id:"performance-characteristics",children:"Performance Characteristics"}),"\n",(0,s.jsx)(n.h3,{id:"benchmarks",children:"Benchmarks"}),"\n",(0,s.jsx)(n.p,{children:"Actual performance of FastProxy depends heavily on:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Hardware specifications"}),": CPU speed, memory, network"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Request patterns"}),": Size, frequency, and complexity of requests"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Processing pipeline"}),": Encryption, signing, and compression settings"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Network conditions"}),": Latency to upstream services"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Typical benchmarks show:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Throughput"}),": 10K-100K+ requests per second depending on configuration"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Latency"}),": Single-digit millisecond overhead with heavy processing enabled"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Memory"}),": ~20MB baseline memory usage with efficient allocation patterns"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Concurrency"}),": Thousands of concurrent connections handled efficiently"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"optimizations",children:"Optimizations"}),"\n",(0,s.jsx)(n.p,{children:"FastProxy incorporates several performance optimizations:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"FastHTTP integration"}),": Uses the fasthttp library for high-performance HTTP handling"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Efficient crypto operations"}),": Optimized AES-GCM and ChaCha20-Poly1305 implementations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Buffer pooling"}),": Reuses buffers to minimize allocations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Smart compression"}),": Selective compression based on content size and type"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Connection reuse"}),": Keeps persistent connections to upstream services"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuration-for-performance",children:"Configuration for Performance"}),"\n",(0,s.jsx)(n.h3,{id:"fasthttp-settings",children:"FastHTTP Settings"}),"\n",(0,s.jsx)(n.p,{children:"Enable FastHTTP in your configuration for significantly improved performance:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'fastHttp:\n  enable: true\n  maxConnsPerHost: 3000           # Maximum connections per destination host\n  maxIdleConnDuration: "30s"      # How long to keep idle connections alive\n  readBufferSize: 4096           # Size of request header reader buffer\n  writeBufferSize: 4096          # Size of response header writer buffer\n'})}),"\n",(0,s.jsx)(n.h3,{id:"http-client-configuration",children:"HTTP Client Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Optimize HTTP client behavior for upstream connections:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'httpClient:\n  MaxIdleConns: 5000              # Maximum idle connections in the pool\n  MaxIdleConnsPerHost: 3000       # Maximum idle connections per host\n  IdleConnTimeout: "90s"          # How long to keep idle connections alive\n  ResponseHeaderTimeout: "10s"    # Timeout for response headers\n  DisableKeepAlives: false        # Reuse connections when possible\n'})}),"\n",(0,s.jsx)(n.h3,{id:"service-specific-tuning",children:"Service-Specific Tuning"}),"\n",(0,s.jsx)(n.p,{children:"Configure per-service performance parameters:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"serviceCallTypeConfig:\n  service_name:\n    /api/endpoint:\n      callType: 1        # 1: direct call, 2: forwarded call\n      qps: 1000         # Queries per second limit\n      timeout: 5000     # Request timeout in milliseconds\n      limit: 2000       # Connection limit\n"})}),"\n",(0,s.jsx)(n.h3,{id:"encryption-performance",children:"Encryption Performance"}),"\n",(0,s.jsx)(n.p,{children:"Encryption settings affect performance significantly:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"AES-GCM provides good performance and security"}),"\n",(0,s.jsx)(n.li,{children:"ChaCha20-Poly1305 performs better on ARM processors"}),"\n",(0,s.jsx)(n.li,{children:"Encryption is typically the biggest performance factor"}),"\n",(0,s.jsx)(n.li,{children:"Consider selective encryption by service based on sensitivity"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"performance-tuning-strategies",children:"Performance Tuning Strategies"}),"\n",(0,s.jsx)(n.h3,{id:"enable-fasthttp",children:"Enable FastHTTP"}),"\n",(0,s.jsx)(n.p,{children:"For high-throughput deployments, FastHTTP is essential:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Lower memory allocation per request"}),"\n",(0,s.jsx)(n.li,{children:"Faster HTTP parsing than standard Go HTTP"}),"\n",(0,s.jsx)(n.li,{children:"Better concurrency handling"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"connection-management",children:"Connection Management"}),"\n",(0,s.jsx)(n.p,{children:"Optimize connection handling for your workload:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Increase ",(0,s.jsx)(n.code,{children:"MaxIdleConns"})," and ",(0,s.jsx)(n.code,{children:"MaxIdleConnsPerHost"})," for high RPS"]}),"\n",(0,s.jsx)(n.li,{children:"Set appropriate timeouts to balance resource usage and responsiveness"}),"\n",(0,s.jsx)(n.li,{children:"Monitor connection pool utilization to adjust parameters"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"compression-optimization",children:"Compression Optimization"}),"\n",(0,s.jsx)(n.p,{children:"FastProxy automatically compresses responses when enabled:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Enable compression for text-based content (JSON, HTML, CSS, JS)"}),"\n",(0,s.jsx)(n.li,{children:"Consider payload sizes - small payloads don't benefit from compression"}),"\n",(0,s.jsx)(n.li,{children:"Choose appropriate compression levels for CPU vs bandwidth trade-off"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,s.jsx)(n.p,{children:"Implement per-service rate limiting to prevent individual services from overwhelming the system:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Set appropriate QPS limits based on upstream service capacity"}),"\n",(0,s.jsx)(n.li,{children:"Use different limits for different endpoints based on complexity"}),"\n",(0,s.jsx)(n.li,{children:"Monitor for rejected requests to adjust limits appropriately"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"monitoring-performance",children:"Monitoring Performance"}),"\n",(0,s.jsx)(n.h3,{id:"built-in-metrics",children:"Built-in Metrics"}),"\n",(0,s.jsx)(n.p,{children:"While FastProxy doesn't expose extensive statistics directly, you can monitor:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Standard server metrics (requests served, connection count)"}),"\n",(0,s.jsx)(n.li,{children:"Request timing and error rates"}),"\n",(0,s.jsx)(n.li,{children:"Throughput and latency measurements"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"logging-performance",children:"Logging Performance"}),"\n",(0,s.jsx)(n.p,{children:"Enable detailed logging in development and testing:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'logging:\n  level: "debug"  # Change to "info" in production\n  format: "json"  # More structured for log aggregation\n'})}),"\n",(0,s.jsx)(n.h3,{id:"profiling",children:"Profiling"}),"\n",(0,s.jsx)(n.p,{children:"The system includes Go's built-in profiler:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"pprof endpoints are available via the imported net/http/pprof"}),"\n",(0,s.jsx)(n.li,{children:"Can analyze CPU usage, memory allocations, and goroutine usage"}),"\n",(0,s.jsx)(n.li,{children:"Helps identify performance bottlenecks and memory leaks"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"production-setup",children:"Production Setup"}),"\n",(0,s.jsx)(n.p,{children:"For optimal performance in production:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enable FastHTTP"})," - This alone provides significant performance improvement"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configure connection pools"})," with appropriate sizes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use efficient encryption algorithms"})," (AES-GCM is recommended)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitor resource usage"})," to identify scaling limits"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Set reasonable timeouts"})," to avoid resource accumulation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use connection persistence"})," to reduce handshake overhead"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"security-vs-performance-trade-offs",children:"Security vs Performance Trade-offs"}),"\n",(0,s.jsx)(n.p,{children:"Balance security and performance by considering:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Encryption/decryption overhead vs security requirements"}),"\n",(0,s.jsx)(n.li,{children:"Signature verification frequency vs integrity needs"}),"\n",(0,s.jsx)(n.li,{children:"Compression benefits vs CPU cost"}),"\n",(0,s.jsx)(n.li,{children:"Connection persistence vs resource usage"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance-testing",children:"Performance Testing"}),"\n",(0,s.jsx)(n.p,{children:"When evaluating performance:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Test with realistic payloads"})," and request patterns"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Measure both average and percentiles"})," (95th, 99th) for latencies"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Validate performance under various load conditions"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitor resource usage"})," (CPU, memory, goroutines) to identify bottlenecks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Test with actual upstream services"})," to include network overhead"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"scaling-considerations",children:"Scaling Considerations"}),"\n",(0,s.jsx)(n.p,{children:"FastProxy scales primarily through:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Horizontal scaling"}),": Adding more proxy instances behind a load balancer"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vertical scaling"}),": Increasing resources on the current machine"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Efficient resource utilization"}),": Tuning connection and buffer settings"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var r=i(6540);const s={},o=r.createContext(s);function t(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);